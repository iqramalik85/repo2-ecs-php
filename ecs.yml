{
  "family": "mytask",
  "containerDefinitions": [
    {
      "name": "php-app-container",
      "image": "y736116236436.dkr.ecr.us-east-1.amazonaws.com/my-img2:latest",
      "cpu": 256,
      "memory": 512,
      "essential": true,
      "portMappings": [
        {
          "containerPort": 80,
          "hostPort": 80
        }
      ],
      "environment": [
        {
          AWS_ACCESS_KEY_ID: "{{ lookup('env', 'AWS_ACCESS_KEY_ID') }}"
        AWS_SECRET_ACCESS_KEY: "{{ lookup('env', 'AWS_SECRET_ACCESS_KEY') }}"
        AWS_DEFAULT_REGION: "{{ aws_region }}"
      ignore_errors: yes  # Ignore errors if the cluster already exists
        }
      ]
    }
  ],
  "requiresCompatibilities": [
    "EC2"
  ],
  "networkMode": "bridge",
  "executionRoleArn": "arn:aws:iam::736116236436:role/ecsTaskExecutionRole",
  "taskRoleArn": "arn:aws:iam::736116236436:role/ecsTaskExecutionRole",
  "volumes": [],
  "placementConstraints": [],
  "memory": "1024",
  "cpu": "512",
  "services": [
    {
      "serviceName": "php-app-service",
      "taskDefinition": "php-app-task",
      "cluster": "ecs-php",
      "desiredCount": 1,
      "launchType": "EC2",
      "networkConfiguration": {
        "awsvpcConfiguration": {
          "subnets": [
            subnets:
            - "subnet-095be323bd97dc9a4"
            - "subnet-0c8e1eaaaff0a0726"
            - "subnet-0e3db30d9fdcb6414"
            - "subnet-04b85618616f2da9d"
            - "subnet-0925766f7ff391b44"
          security_groups:
            - "sg-0a85d937517e6a7b1"
          ]
        }
      },
      "platformVersion": "LATEST"
    }
  ]
}
